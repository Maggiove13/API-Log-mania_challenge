# Api_logs

This project is a simple log management API built with Python, and SQL Server. 
This application manages and stores event logs generated by simulated services. It allows sending logs to a central server and querying logs through an API with API key authentication for security.

## Instructions to get started

Follow these instructions to begin

## Prerequisites

SQL Server Studio 20
ODBC Driver 18 for SQL Server


## Set up the table

```
CREATE TABLE logs (
    id INT IDENTITY(1,1) PRIMARY KEY,
    Timestamp DATETIME,
    Service_name VARCHAR(255),
    Log_level VARCHAR(50),
    Message NVARCHAR(MAX),
    received_at DATETIME --- the time at which the log is received by the server
);
```

## Define your environment variables

Create a '.env' file in the root directory and add the following environment variables:
Example:

```.env
    API_KEY=tu_api_key
    DATABASE=tu_base_de_datos
    USER=tu_usuario
    PASSWORD=tu_contraseña
```

## Usage

To interact with the API, you must send HTTP requests with the following headers and body in JSON format.

### Required Headers

- Content-Type': application/json**: Indicates that the request body is in JSON format.
- **'x-api-key': your_api_key**: Replaces `your_api_key` with your API key to authenticate the request.

### POST Request Example
Here is an example of how to submit a record to the API:

**Solicitud**

```
    http
    POST /logs HTTP/1.1
    Host: localhost:5000
    Content-Type: application/json
    x-api-key: your_api_key

    {
      "timestamp": "2024-08-04T12:34:56.789Z",
      "service_name": "Service1",
      "log_level": "info",
      "message": "This is an info message from Service1"
    }
```

**Examples:**
To send logs, use the provided sendLog.py script. This script generates random logs and sends them to the API.

Querying Logs
To query logs, send a GET request to the /logs endpoint with optional query parameters.

To obteing logs from the server, make a GET request:
try this:

´´´

    localhost:5000/logs?start_timestamp=2024-08-07&end_timestamp=2024-08-10

´´´
